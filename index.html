<!DOCTYPE html>
<html>
  <head>
    <title>Animate.web</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
    <!-- Load script locally for development ↓↓↓ -->
    <script src="dist/animate.web.js"></script>
    <!--<script src="https://cdn.jsdelivr.net/npm/animate.web@latest/dist/animate.web.js"></script>-->
    <!--  Load from cdn: jsdelivr ↑↑↑ or unpkg ↓↓↓ -->
    <!--<script src="https://unpkg.com/animate.web"></script>-->
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@latest/css/all.min.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/npm/ionicons@latest/dist/css/ionicons.min.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/npm/eva-icons@latest/style/eva-icons.css" rel="stylesheet" type="text/css" />
    <!--    <link href="https://themify.me/wp-content/themes/themify-v32/themify-icons/themify-icons.css" rel="stylesheet" type="text/css" />-->
    <link href="https://cdn.jsdelivr.net/npm/line-awesome@latest/dist/line-awesome/css/line-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@latest/css/materialdesignicons.min.css" rel="stylesheet" type="text/css" />

    <link href="https://cdn.jsdelivr.net/npm/quasar@latest/dist/quasar.min.css" rel="stylesheet" type="text/css" />
    <link href="https://cdn.jsdelivr.net/npm/@quasar/quasar-ui-qiconpicker@latest/dist/index.min.css" rel="stylesheet" type="text/css" />

    <link id="favicon" rel="shortcut icon" type="image/svg+xml" href="https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@latest/svgs/brands/github.svg" />
  </head>
  <body>
    <script src="https://cdn.jsdelivr.net/npm/vue@^2.0.0/dist/vue.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/quasar@^1.9.1/dist/quasar.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@quasar/quasar-ui-qiconpicker@latest/dist/index.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@quasar/quasar-ui-qiconpicker@latest/dist/icon-set/material-icons.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@quasar/quasar-ui-qiconpicker@latest/dist/icon-set/eva-icons.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@quasar/quasar-ui-qiconpicker@latest/dist/icon-set/fontawesome-v5.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@quasar/quasar-ui-qiconpicker@latest/dist/icon-set/ionicons-v4.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@quasar/quasar-ui-qiconpicker@latest/dist/icon-set/mdi-v4.umd.js"></script>
    <!--    <script src="https://cdn.jsdelivr.net/npm/@quasar/quasar-ui-qiconpicker@latest/dist/icon-set/themify.umd.js"></script>-->
    <script src="https://cdn.jsdelivr.net/npm/@quasar/quasar-ui-qiconpicker/dist/icon-set/line-awesome.umd.js"></script>

    <div id="q-app">
      <q-layout view="hHh lpR fFf" class="shadow-2 rounded-borders">
        <q-header elevated reveal>
          <q-toolbar class="bg-primary glossy text-white">
            <q-toolbar-title
              >Animate.web
              <div class="text-subtitle2">$ yarn add animate.web&nbsp;</div>
            </q-toolbar-title>

            <q-btn flat dense round @click="drawer = !drawer" aria-label="Menu">
              <q-icon name="menu" size="md"></q-icon>
            </q-btn>
          </q-toolbar>
        </q-header>

        <q-drawer v-model="drawer" side="right" show-if-above>
          <q-list no-border link inset-delimiter>
            <drawer-menu-item v-for="(item, index) in drawerMenuItems" :key="'drawer-' + index" :url="item.url" :icon="item.icon" :label="item.label" :caption="item.caption"></drawer-menu-item>
          </q-list>
        </q-drawer>

        <q-page-container>
          <q-page>
            <div class="row">
              <div class="q-ma-md" style="min-width: 30%; max-width: 100%;">
                <q-card style="text-align: center;">
                  <q-card-section>
                    <q-table title="Keyframes" :data="keyframesData.data" :columns="keyframesData.columns" :pagination.sync="keyframesPagination" :rows-per-page-options="[0]" hide-bottom></q-table>
                  </q-card-section>
                </q-card>
              </div>

              <div class="q-ma-md" style="min-width: 30%; max-width: 100%;">
                <q-card bordered style="text-align: center;">
                  <q-card-section>
                    <q-icon :name="icon" style="font-size: 10vw;z-index: 1000000" id="icon"></q-icon>
                    <div class="text-h6 q-mt-md">Icon: <q-badge color="secondary">{{icon}}</q-badge></div>
                    <div class="text-h6 q-mb-md">Animation: <q-badge color="accent">{{animationName}}</q-badge></div>
                    <q-btn round color="primary" icon="navigate_before" @click="prevNext('prev')"></q-btn>
                    <q-btn round color="primary" icon="play_arrow" @click="animate(animationName)" class="q-mr-md q-ml-md"></q-btn>
                    <q-btn round color="primary" icon="navigate_next" @click="prevNext('next')"></q-btn>
                  </q-card-section>
                  <q-card-section>
                    <q-btn color="primary" label="Select animation">
                      <categories-menu :categories="animateweb.categories"></categories-menu>
                    </q-btn>
                  </q-card-section>
                </q-card>
              </div>

              <div class="q-ma-md" style="min-width: 350px; max-width: 350px;">
                <q-card bordered style="text-align: center;">
                  <q-card-section>
                    <q-select v-model="iconSet" :options="iconSets" label="Select icon set" dense></q-select>
                    <q-input v-model="filter" label="Filter" dense clearable class="q-ma-md"> </q-input>
                    <q-icon-picker v-model="icon" :icon-set="iconSet" :pagination.sync="pagination" :filter="filter" tooltips style="height: 490px"></q-icon-picker>
                  </q-card-section>
                </q-card>
              </div>
            </div>
          </q-page>
        </q-page-container>
      </q-layout>
    </div>
    <script>
      /* global Vue, Quasar, animateweb */

      Vue.component('drawer-menu-item', {
        props: ['url', 'icon', 'label', 'caption'],
        template: `
            <q-item clickable v-ripple @click="Quasar.utils.openURL(url)">
              <q-item-section avatar>
                <q-icon color="primary" :name="icon"></q-icon>
              </q-item-section>
              <q-item-section>
                <q-item-label>{{label}}</q-item-label>
                <q-item-label caption>{{caption}}</q-item-label>
              </q-item-section>
            </q-item>`
      })

      Vue.component('categories-menu', {
        props: ['categories', 'anchor', 'self', 'level'],
        template: `
          <q-menu max-height="100vh" :anchor="anchor" :self="self">
            <q-list dense style="min-width: 100px">
              <template v-for="value, key, index in categories" :key="'item-' + level + '-' + index">

                <q-item clickable v-if="value !== true">
                  <q-item-section style="white-space: nowrap;">{{key}}</q-item-section>
                  <q-item-section side>
                    <q-icon name="keyboard_arrow_right"></q-icon>
                  </q-item-section>
                  <categories-menu :categories="value" anchor="top right" self="top left" :level="level + 1"></categories-menu>
                </q-item>

                <q-item dense clickable @click="$root.animate(key)" v-if="value === true">
                  <q-item-section>{{key}}</q-item-section>
                </q-item>

              </template>
              <q-separator></q-separator>
            </q-list>
          </q-menu>`
      })

      new Vue({
        el: '#q-app',

        data: function() {
          return {
            animationName: 'flip',
            iconSet: 'material-icons',
            icon: 'fab fa-jenkins',
            filter: '',
            keyframesPagination: {
              rowsPerPage: 0
            },
            pagination: {
              itemsPerPage: 60,
              page: 0
            },
            drawer: false
          }
        },

        created() {
          this.iconSets = [
            'material-icons', //
            'mdi-v4',
            'ionicons-v4',
            'eva-icons',
            'fontawesome-v5',
            // 'themify',
            'line-awesome'
          ]
          this.drawerMenuItems = [
            {
              url: 'https://github.com/webanimate/animate.web',
              icon: 'fab fa-github',
              label: 'Github repository',
              caption: 'View repository on Github'
            },
            {
              url: 'https://npmjs.com/package/animate.web',
              icon: 'fab fa-npm',
              label: 'NPM package',
              caption: 'View package on NPM'
            },
            {
              url: 'https://github.com/webanimate/animate.web/blob/master/index.html',
              icon: 'fab fa-github-alt',
              label: 'Github demo',
              caption: 'View source of this demo'
            },
            {
              url: 'https://quasar.dev/',
              icon: 'img:https://cdn.quasar.dev/logo/svg/quasar-logo.svg',
              label: 'Running on Quasar v' + Quasar.version,
              caption: 'Visit Quasar website'
            }
          ]
          this.animation = null
          this.animationsNames = Object.keys(animateweb)
          this.animationsNames.splice(this.animationsNames.indexOf('categories'), 1)
        },

        mounted() {
          this.animation = document.querySelector('#icon').animate(animateweb[this.animationName].keyframes, animateweb[this.animationName].options)
        },

        computed: {
          keyFrames: function() {
            return animateweb[this.animationName].keyframes
          },

          keyframesData: function() {
            const properties = {}
            const columns = []
            const data = []
            for (const val of Object.keys(animateweb[this.animationName].keyframes)) {
              const _data = {}
              Object.keys(animateweb[this.animationName].keyframes[val]).forEach(key => {
                properties[key] = true
                _data[key] = animateweb[this.animationName].keyframes[val][key]
              })
              data.push(_data)
            }
            Object.keys(properties).forEach(key => {
              columns.push({
                name: key,
                label: key,
                field: key,
                align: 'left'
              })
            })
            return { data: data, columns: columns }
          }
        },

        methods: {
          animate(name) {
            if (name === this.animationName) {
              this.animation.cancel()
              this.animation.play()
            } else {
              this.animationName = name
              this.animation = document.querySelector('#icon').animate(animateweb[name].keyframes, animateweb[name].options)
            }
          },

          prevNext(direction = 'next') {
            let index = this.animationsNames.indexOf(this.animationName)
            if (direction === 'next') {
              if (index >= this.animationsNames.length - 1) index = -1
              index++
            } else {
              if (index <= 0) index = this.animationsNames.length
              index--
            }
            this.animate(this.animationsNames[index])
          },

          filterFn(val, update) {
            if (val === '') {
              update(() => {
                this.options = this._options
              })
              return
            }

            update(() => {
              const needle = val.toLowerCase()
              this.options = this._options.filter(v => v.toLowerCase().indexOf(needle) > -1)
            })
          }
        }
      })
    </script>
  </body>
</html>
